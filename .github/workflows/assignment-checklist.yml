name: Assignment Checklist Validator

on:
  workflow_dispatch:
  push:
    branches: [ main, master ]

jobs:
  validate-assignment:
    name: Validate Assignment Requirements
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Validate Assignment Requirements
        run: |
          echo "# Assignment Requirements Validation" > assignment_checklist.md
          echo "" >> assignment_checklist.md
          echo "## âœ… Checklist" >> assignment_checklist.md
          echo "" >> assignment_checklist.md
          
          # 1. Application Development
          echo "### 1. Application Development" >> assignment_checklist.md
          if [ -f "app.py" ] && [ -f "app_v1.1.py" ] && [ -f "app_v1.2.py" ] && [ -f "app_v1.3.py" ]; then
            echo "âœ… Flask application files (all versions)" >> assignment_checklist.md
          else
            echo "âŒ Missing application files" >> assignment_checklist.md
          fi
          echo "" >> assignment_checklist.md
          
          # 2. Version Control
          echo "### 2. Version Control System" >> assignment_checklist.md
          if [ -d ".git" ]; then
            echo "âœ… Git repository initialized" >> assignment_checklist.md
          else
            echo "âŒ Git repository not initialized" >> assignment_checklist.md
          fi
          echo "" >> assignment_checklist.md
          
          # 3. Unit Testing
          echo "### 3. Unit Testing and Test Automation" >> assignment_checklist.md
          if [ -f "tests/test_app.py" ] && [ -f "pytest.ini" ]; then
            echo "âœ… Pytest test cases present" >> assignment_checklist.md
          else
            echo "âŒ Missing test files" >> assignment_checklist.md
          fi
          echo "" >> assignment_checklist.md
          
          # 4. Jenkins
          echo "### 4. Continuous Integration with Jenkins" >> assignment_checklist.md
          if [ -f "Jenkinsfile" ]; then
            echo "âœ… Jenkinsfile present" >> assignment_checklist.md
          else
            echo "âŒ Jenkinsfile missing" >> assignment_checklist.md
          fi
          echo "" >> assignment_checklist.md
          
          # 5. Docker
          echo "### 5. Containerization with Docker" >> assignment_checklist.md
          if [ -f "Dockerfile" ] && [ -f "Dockerfile.v1.1" ] && [ -f "Dockerfile.v1.2" ] && [ -f "Dockerfile.v1.3" ]; then
            echo "âœ… All Dockerfiles present" >> assignment_checklist.md
          else
            echo "âŒ Missing Dockerfiles" >> assignment_checklist.md
          fi
          echo "" >> assignment_checklist.md
          
          # 6. Kubernetes
          echo "### 6. Kubernetes Deployment Strategies" >> assignment_checklist.md
          strategies=("rolling-update" "blue-green" "canary" "shadow" "ab-testing")
          all_present=true
          for strategy in "${strategies[@]}"; do
            if [ -f "k8s/${strategy}-deployment.yaml" ]; then
              echo "âœ… ${strategy} deployment present" >> assignment_checklist.md
            else
              echo "âŒ ${strategy} deployment missing" >> assignment_checklist.md
              all_present=false
            fi
          done
          echo "" >> assignment_checklist.md
          
          # 7. SonarQube
          echo "### 7. SonarQube Configuration" >> assignment_checklist.md
          if [ -f "sonar-project.properties" ]; then
            echo "âœ… SonarQube configuration present" >> assignment_checklist.md
          else
            echo "âŒ SonarQube configuration missing" >> assignment_checklist.md
          fi
          echo "" >> assignment_checklist.md
          
          # 8. Documentation
          echo "### 8. Documentation" >> assignment_checklist.md
          if [ -f "README.md" ]; then
            echo "âœ… README.md present" >> assignment_checklist.md
          else
            echo "âŒ README.md missing" >> assignment_checklist.md
          fi
          if [ -f "ASSIGNMENT_REPORT.md" ]; then
            echo "âœ… ASSIGNMENT_REPORT.md present" >> assignment_checklist.md
          else
            echo "âŒ ASSIGNMENT_REPORT.md missing" >> assignment_checklist.md
          fi
          echo "" >> assignment_checklist.md
          
          # Summary
          echo "## ğŸ“Š Summary" >> assignment_checklist.md
          echo "" >> assignment_checklist.md
          echo "Validation completed at: $(date)" >> assignment_checklist.md
          echo "" >> assignment_checklist.md
          
          cat assignment_checklist.md

      - name: Upload checklist
        uses: actions/upload-artifact@v4
        with:
          name: assignment-checklist
          path: assignment_checklist.md

